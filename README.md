# DNSCrypt-Proxy UI

A modern web interface for managing DNSCrypt-Proxy settings and monitoring logs.

## Features

- Real-time log monitoring with filtering and search
- Configuration management through a user-friendly interface
- Support for all major DNSCrypt-Proxy settings
- Dark mode support
- Responsive design

## Prerequisites

- Node.js 16 or higher
- npm 7 or higher
- DNSCrypt-Proxy installed on your system

## Installation

1. Clone the repository:
```bash
git clone https://github.com/yourusername/dnscrypt-proxy-ui.git
cd dnscrypt-proxy-ui
```

2. Install dependencies:
```bash
npm install
```

3. Set up the configuration:
```bash
npm run setup
```
This script will guide you through creating your initial `config/dnscrypt-proxy.toml` file, typically by copying from `config/dnscrypt-proxy.toml.example` and prompting for initial settings. You can modify these settings later through the web interface.

## Usage

1. Start the application:
```bash
npm start
```
This will start both the backend server and frontend development server.

2. Access the web interface:
- Frontend: http://localhost:5173
- Backend API: http://localhost:3000

## Configuration

The application uses a TOML configuration file located at `config/dnscrypt-proxy.toml`. You can:

1. Create a new configuration using the setup script:
```bash
npm run setup
```

2. Modify the configuration through the web interface:
- Navigate to the Settings tab
- Make your changes
- Click "Save Changes"

3. Manually edit the configuration file:
- The file is located at `config/dnscrypt-proxy.toml`
- A sample configuration is available at `config/dnscrypt-proxy.toml.example`

## Development

- Start the development server:
```bash
npm run dev
```

- Start the backend server:
```bash
npm run server
```

- Run tests:
```bash
npm test
```
To run specific test files, use `jest <path/to/test/file>`. For example: `npm test -- src/services/__tests__/FileSystemService.test.js`.
To view test coverage, run `npm test -- --coverage` and open `coverage/lcov-report/index.html` in your browser.

- Format code:
```bash
npm run format
```

## Project Structure

```
dnscrypt-proxy-ui/
├── config/                 # Application configuration files, including DNSCrypt-Proxy TOML.
├── logs/                   # Log files generated by the application.
├── public/                 # Static assets served by the web server.
├── scripts/                # Utility scripts for setup, build, etc.
├── src/
│   ├── assets/             # Static assets used by the React application.
│   ├── components/         # Reusable React UI components.
│   ├── config/             # Frontend-specific configuration and defaults.
│   ├── middleware/         # Express.js middleware for security and validation.
│   ├── pages/              # React components representing different application pages.
│   ├── services/           # Backend API logic and frontend service clients.
│   ├── utils/              # Utility functions.
│   ├── App.jsx             # Main React application component.
│   ├── index.css           # Main CSS file for TailwindCSS.
│   └── main.jsx            # Entry point for the React application.
├── .gitignore
├── package.json
└── README.md
```

## Troubleshooting

### DNSCrypt-Proxy Not Running or Accessible
If the UI cannot connect to DNSCrypt-Proxy, ensure:
- DNSCrypt-Proxy is installed and running on your system.
- The `listen_address` in your `dnscrypt-proxy.toml` matches the address the UI is trying to connect to (default: `127.0.0.1:53`).

### Port Conflicts
If `npm start` fails due to a port being in use (e.g., 3000 for the backend API or 5173 for the frontend development server):
- Identify the process using the port (e.g., `lsof -i :3000` on Linux/macOS, `netstat -ano | findstr :3000` on Windows).
- Terminate the conflicting process, or change the ports used by the UI (refer to `src/services/Server.js` for backend and `vite.config.js` for frontend).

### Configuration File Issues
If the UI reports issues with the configuration file:
- Ensure `config/dnscrypt-proxy.toml` exists and is correctly formatted TOML.
- You can regenerate it using `npm run setup`.
- Compare your `dnscrypt-proxy.toml` with `config/dnscrypt-proxy.toml.example` for syntax or structural errors.

## Security Considerations

- **Dependency Updates:** Regularly update project dependencies to mitigate known vulnerabilities.
- **Network Exposure:** By default, the backend API runs on `http://localhost:3000`. Avoid exposing this port to the public internet unless absolutely necessary and with proper security measures in place (e.g., firewalls, authentication).
- **Input Validation:** While the application includes validation, always be mindful of user-provided inputs, especially when interacting with the underlying DNSCrypt-Proxy configuration.

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

This project is licensed under the MIT License - see the LICENSE file for details.